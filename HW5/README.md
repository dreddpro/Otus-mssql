# Оконные функции. ДЗ
___
## Цели занятия
писать запросы с использованием оконных функций;  
проходить тест по оконным функциям.
___
## Краткое содержание
windows функции в SQL - ROW_NUMBER, LAG, LEAD, NTILE;
почему они оконные? чем выгодны;
сравним планы с оконными функциями и без них.
___
## Результаты
примеры с выборками с оконными функциями.
___
## Преподаватель
Дмитрий Тарасов
___
## Дата и время
18 апреля, четверг в 20:00
Длительность занятия: 90 минут
___
## Материалы
___
# Домашнее задание
___
## Цель:
В этом ДЗ вы научитесь писать запрос с временной таблицей и с табличной переменной.
___

## Описание/Пошаговая инструкция выполнения домашнего задания:

Более подробно задание описано в материалах в личном кабинете.

Сделать расчет суммы продаж нарастающим итогом по месяцам с 2015 года
(в рамках одного месяца он будет одинаковый, нарастать будет в течение времени выборки).
Нарастающий итог должен быть без оконной функции.
Сделайте расчет суммы нарастающим итогом в предыдущем запросе с помощью оконной функции.
Сравните производительность запросов 1 и 2 с помощью set statistics time, io on
Вывести список 2х самых популярных продуктов (по количеству проданных)
в каждом месяце за 2016 год (по 2 самых популярных продукта в каждом месяце).
Функции одним запросом
Посчитайте по таблице товаров (в вывод также должен попасть ид товара, название, брэнд и цена):
пронумеруйте записи по названию товара, так чтобы при изменении буквы алфавита нумерация начиналась заново
посчитайте общее количество товаров и выведете полем в этом же запросе
посчитайте общее количество товаров в зависимости от первой буквы названия товара
отобразите следующий id товара исходя из того, что порядок отображения товаров по имени
предыдущий ид товара с тем же порядком отображения (по имени)
названия товара 2 строки назад, в случае если предыдущей строки нет нужно вывести "No items"
сформируйте 30 групп товаров по полю вес товара на 1 шт

Для этой задачи НЕ нужно писать аналог без аналитических функций.
По каждому сотруднику выведите последнего клиента, которому сотрудник что-то продал.
В результатах должны быть ид и фамилия сотрудника, ид и название клиента, дата продажи, сумму сделки.
Выберите по каждому клиенту два самых дорогих товара, которые он покупал.
В результатах должно быть ид клиета, его название, ид товара, цена, дата покупки.

Опционально можете для каждого запроса без оконных функций сделать вариант запросов с оконными функциями и сравнить их производительность.
---
# Решение
[Здесь](homework_group_by-188-f40326_KomisarchukSV.sql)